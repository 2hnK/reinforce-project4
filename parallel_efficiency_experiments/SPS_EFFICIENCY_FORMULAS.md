# SPSì™€ Efficiency ê³„ì‚° ì‹ ì •ë¦¬

## ğŸ“Š 1. SPS (Steps Per Second)

### ì •ì˜
**ì´ˆë‹¹ ì²˜ë¦¬í•˜ëŠ” í™˜ê²½ ìŠ¤í… ìˆ˜** - ë³‘ë ¬í™”ì˜ ì²˜ë¦¬ëŸ‰ì„ ë‚˜íƒ€ë‚´ëŠ” í•µì‹¬ ì§€í‘œ

### ê³„ì‚° ì‹
```python
SPS = num_env_steps_sampled / time_this_iter_s
```

### êµ¬ì„± ìš”ì†Œ
- `num_env_steps_sampled`: í•´ë‹¹ iterationì—ì„œ ìˆ˜ì§‘í•œ ì´ í™˜ê²½ ìŠ¤í… ìˆ˜
- `time_this_iter_s`: í•´ë‹¹ iterationì— ì†Œìš”ëœ ì‹œê°„ (ì´ˆ)

### ì‹¤í—˜ ì˜ˆì‹œ
```python
# Baseline (1rÃ—1e)
num_env_steps = 16,384  # train_batch_size
time_this_iter = 11.89s
SPS = 16,384 / 11.89 = 1,378 steps/s

# ë³‘ë ¬í™” (8rÃ—2e, 16 total envs)
num_env_steps = 16,384  # ë™ì¼í•œ batch size
time_this_iter = 2.20s
SPS = 16,384 / 2.20 = 7,455 steps/s
```

### ì˜ë¯¸ í•´ì„
- **SPSê°€ ë†’ì„ìˆ˜ë¡**: ê°™ì€ ì‹œê°„ì— ë” ë§ì€ ê²½í—˜ ìˆ˜ì§‘ â†’ í•™ìŠµ ì†ë„ í–¥ìƒ
- **ë¹„êµ ì¡°ê±´**: `num_env_steps`ê°€ ë™ì¼í•´ì•¼ ê³µì •í•œ ë¹„êµ ê°€ëŠ¥
- **í™œìš©**: ì‹¤ì‹œê°„ ì²˜ë¦¬ëŸ‰ ëª¨ë‹ˆí„°ë§, ë³‘ë ¬í™” íš¨ê³¼ ì¸¡ì •

---

## âš¡ 2. Speedup (ê°€ì†ë¹„)

### ì •ì˜
**ë² ì´ìŠ¤ë¼ì¸ ëŒ€ë¹„ ëª‡ ë°° ë¹¨ë¼ì¡ŒëŠ”ê°€** - ë³‘ë ¬í™”ì˜ ì ˆëŒ€ì  ì„±ëŠ¥ í–¥ìƒ

### ê³„ì‚° ì‹
```python
Speedup = T_baseline / T_parallel
ë˜ëŠ”
Speedup = SPS_parallel / SPS_baseline
```

### êµ¬ì„± ìš”ì†Œ
- `T_baseline`: ë² ì´ìŠ¤ë¼ì¸ êµ¬ì„±(1rÃ—1e)ì˜ iteration ì‹œê°„
- `T_parallel`: ë³‘ë ¬ êµ¬ì„±ì˜ iteration ì‹œê°„
- `SPS_baseline`: ë² ì´ìŠ¤ë¼ì¸ SPS
- `SPS_parallel`: ë³‘ë ¬ êµ¬ì„± SPS

### ì‹¤í—˜ ì˜ˆì‹œ
```python
# ë°©ë²• 1: ì‹œê°„ ê¸°ë°˜
T_baseline = 11.89s  # 1rÃ—1e
T_parallel = 2.20s   # 8rÃ—2e
Speedup = 11.89 / 2.20 = 5.41Ã—

# ë°©ë²• 2: SPS ê¸°ë°˜
SPS_baseline = 1,378 steps/s
SPS_parallel = 7,455 steps/s
Speedup = 7,455 / 1,378 = 5.41Ã—
```

### ì´ìƒì  vs ì‹¤ì œ
```python
# ì´ìƒì  ì„ í˜• í™•ì¥
Parallelism = 16 (8rÃ—2e)
Ideal_Speedup = 16.00Ã—

# ì‹¤ì œ ì¸¡ì •
Actual_Speedup = 5.41Ã—

# íš¨ìœ¨ì„± ì†ì‹¤
Loss = (16.00 - 5.41) / 16.00 = 66.2%
```

---

## ğŸ¯ 3. Efficiency (ë³‘ë ¬ íš¨ìœ¨ì„±)

### ì •ì˜
**íˆ¬ì…í•œ ë³‘ë ¬ ìì› ëŒ€ë¹„ ì‹¤ì œë¡œ ì–»ì€ ì„±ëŠ¥ í–¥ìƒ ë¹„ìœ¨**

### ê³„ì‚° ì‹
```python
Efficiency = (Speedup / Parallelism) Ã— 100%
```

ë˜ëŠ” ì‹œê°„ ê¸°ë°˜ìœ¼ë¡œ í’€ì–´ì“°ë©´:
```python
Efficiency = (T_baseline / T_parallel / N) Ã— 100%
```

### êµ¬ì„± ìš”ì†Œ
- `Speedup`: ê°€ì†ë¹„
- `Parallelism (N)`: ë³‘ë ¬í™” ìˆ˜ì¤€ = `num_env_runners Ã— num_envs_per_env_runner`
- `T_baseline`: ë² ì´ìŠ¤ë¼ì¸ ì‹œê°„
- `T_parallel`: ë³‘ë ¬ êµ¬ì„± ì‹œê°„

### ì‹¤í—˜ ì˜ˆì‹œ

#### ì˜ˆì‹œ 1: ë†’ì€ íš¨ìœ¨ (2rÃ—1e)
```python
T_baseline = 11.89s
T_parallel = 7.24s
Parallelism = 2

Speedup = 11.89 / 7.24 = 1.64Ã—
Efficiency = (1.64 / 2) Ã— 100% = 82.1%
```

#### ì˜ˆì‹œ 2: ë‚®ì€ íš¨ìœ¨ (8rÃ—2e)
```python
T_baseline = 11.89s
T_parallel = 2.20s
Parallelism = 16

Speedup = 11.89 / 2.20 = 5.41Ã—
Efficiency = (5.41 / 16) Ã— 100% = 33.8%
```

### íš¨ìœ¨ì„± í•´ì„

| Efficiency | í‰ê°€ | ì˜ë¯¸ |
|-----------|------|------|
| **100%** | ì™„ë²½ | ì´ìƒì  ì„ í˜• í™•ì¥ (Në°° ìì› â†’ Në°° ì†ë„) |
| **80-100%** | ìš°ìˆ˜ | ë§¤ìš° íš¨ìœ¨ì  ë³‘ë ¬í™” (ë¯¸ë¯¸í•œ ì˜¤ë²„í—¤ë“œ) |
| **60-80%** | ì–‘í˜¸ | ìˆ˜ìš© ê°€ëŠ¥í•œ ë³‘ë ¬í™” (ì‹¤ìš©ì ) |
| **40-60%** | ë³´í†µ | ìƒë‹¹í•œ ì˜¤ë²„í—¤ë“œ ì¡´ì¬ |
| **< 40%** | ë¹„íš¨ìœ¨ | ìì› ë‚­ë¹„, ì¬ê²€í†  í•„ìš” |

---

## ğŸ“ 4. ì‹¤í—˜ ê²°ê³¼ ì¢…í•©

### ì „ì²´ êµ¬ì„± ë¹„êµ

| Config | Parallelism (N) | Time (s) | Speedup | Efficiency | í‰ê°€ |
|--------|----------------|----------|---------|-----------|------|
| 1rÃ—1e | 1 | 11.89 | 1.00Ã— | 100.0% | Baseline |
| 2rÃ—1e | 2 | 7.24 | 1.64Ã— | **82.1%** | â­â­â­ ìµœê³  íš¨ìœ¨ |
| 4rÃ—1e | 4 | 4.39 | 2.71Ã— | **67.7%** | â­â­â­ ê¶Œì¥ |
| 8rÃ—1e | 8 | 2.89 | 4.12Ã— | 51.5% | â­â­ ìˆ˜ìš© |
| 1rÃ—2e | 2 | 7.82 | 1.52Ã— | 76.0% | â­â­â­ ìš°ìˆ˜ |
| 2rÃ—2e | 4 | 4.94 | 2.41Ã— | 60.2% | â­â­ ì–‘í˜¸ |
| 1rÃ—4e | 4 | 5.93 | 2.01Ã— | 50.1% | â­ ë³´í†µ |
| 1rÃ—8e | 8 | 4.60 | 2.59Ã— | 32.3% | âŒ ë¹„íš¨ìœ¨ |
| 2rÃ—4e | 8 | 3.92 | 3.03Ã— | 37.9% | âš ï¸ ë¹„íš¨ìœ¨ |
| 8rÃ—2e | 16 | 2.20 | **5.41Ã—** | 33.8% | â­ ë¹ ë¥´ë‚˜ ë¹„íš¨ìœ¨ |

### ê³„ì‚° ê²€ì¦ ì˜ˆì‹œ (4rÃ—1e)

```python
# ì£¼ì–´ì§„ ê°’
T_baseline = 11.89s
T_parallel = 4.39s
N = 4 (4 runners Ã— 1 env)

# Step 1: Speedup ê³„ì‚°
Speedup = T_baseline / T_parallel
        = 11.89 / 4.39
        = 2.71Ã—

# Step 2: Efficiency ê³„ì‚°
Efficiency = (Speedup / N) Ã— 100%
          = (2.71 / 4) Ã— 100%
          = 67.7%

# í•´ì„:
# - 4ë°° ìì› íˆ¬ì… â†’ 2.71ë°° ì†ë„ í–¥ìƒ
# - íš¨ìœ¨ì„± 67.7% â†’ ì•½ 33% ì˜¤ë²„í—¤ë“œ ì†ì‹¤
# - ì‹¤ìš©ì ìœ¼ë¡œ ìˆ˜ìš© ê°€ëŠ¥í•œ ìˆ˜ì¤€
```

---

## ğŸ” 5. ì´ìƒì  vs ì‹¤ì œ ë¹„êµ

### ê·¸ë˜í”„ ê°œë…ë„

```
Speedup
 16 â”¤                                    â—ì´ìƒì  (100% íš¨ìœ¨)
 14 â”¤                              â—
 12 â”¤                         â—
 10 â”¤                    â—
  8 â”¤               â—              
  6 â”¤          â—                         â—ì‹¤ì œ (8rÃ—2e: 5.41Ã—)
  4 â”¤     â—                         â—ì‹¤ì œ (8rÃ—1e: 4.12Ã—)
  2 â”¤ â—                        â—ì‹¤ì œ (4rÃ—1e: 2.71Ã—)
  0 â”¤â—ì‹¤ì œ (2rÃ—1e: 1.64Ã—)
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€> Total Envs (N)
          2     4     6     8    10    16

íš¨ìœ¨ì„± = ì‹¤ì œ ê³¡ì„ ê³¼ ì´ìƒ ê³¡ì„ ì˜ ë¹„ìœ¨
```

### íš¨ìœ¨ì„± ì €í•˜ ì›ì¸

```python
# 100% íš¨ìœ¨ ë¶ˆê°€ëŠ¥í•œ ì´ìœ 

ì´ ì‹œê°„ = ë³‘ë ¬ ì‘ì—… ì‹œê°„ + ì˜¤ë²„í—¤ë“œ

ì˜¤ë²„í—¤ë“œ êµ¬ì„±:
1. í†µì‹  ì˜¤ë²„í—¤ë“œ (30-40%)
   - í”„ë¡œì„¸ìŠ¤ ê°„ ë°ì´í„° ì „ì†¡
   - ì§ë ¬í™”/ì—­ì§ë ¬í™”
   
2. ë™ê¸°í™” ë¹„ìš© (20-30%)
   - ëª¨ë“  worker ì™„ë£Œ ëŒ€ê¸°
   - Straggler problem
   
3. ë¦¬ì†ŒìŠ¤ ê²½í•© (10-20%)
   - CPU ìºì‹œ ê²½í•©
   - ë©”ëª¨ë¦¬ ëŒ€ì—­í­ ì œí•œ
   
4. ì§ë ¬ êµ¬ê°„ (Amdahl's Law)
   - learner ì—…ë°ì´íŠ¸ (ë‹¨ì¼ GPU)
   - ê²°ê³¼ ì§‘ê³„
```

---

## ğŸ“ 6. Amdahl's Law ì ìš©

### ì´ë¡ ì  ë°°ê²½

```python
Speedup_max = 1 / (s + (1-s)/N)
```

ì—¬ê¸°ì„œ:
- `s`: ì§ë ¬ êµ¬ê°„ ë¹„ìœ¨ (ë³‘ë ¬í™” ë¶ˆê°€ëŠ¥)
- `N`: ë³‘ë ¬í™” ìˆ˜ì¤€
- `1-s`: ë³‘ë ¬ êµ¬ê°„ ë¹„ìœ¨

### ì‹¤í—˜ ë°ì´í„° ì—­ì‚°

```python
# ì‹¤í—˜ ê²°ê³¼ë¡œë¶€í„° s ì¶”ì •
# 8rÃ—2e (N=16, Speedup=5.41Ã—)

5.41 = 1 / (s + (1-s)/16)
5.41 Ã— (s + (1-s)/16) = 1
5.41s + 5.41(1-s)/16 = 1
5.41s + 0.338(1-s) = 1
5.41s + 0.338 - 0.338s = 1
5.072s = 0.662
s â‰ˆ 0.13 (13%)

# ê²€ì¦: ë³‘ë ¬ êµ¬ê°„ 87%
Speedup_max (N=16) = 1 / (0.13 + 0.87/16) = 5.71Ã—
Actual = 5.41Ã— â†’ ê·¼ì‚¬ ì¼ì¹˜!
```

### ì´ë¡ ì  í•œê³„

```python
# ë¬´í•œëŒ€ ë³‘ë ¬í™” ì‹œ ìµœëŒ€ Speedup
N â†’ âˆ
Speedup_max = 1 / s = 1 / 0.13 â‰ˆ 7.69Ã—

# í˜„ì¬ ë‹¬ì„± (N=16): 5.41Ã—
# ì´ë¡ ì  ìµœëŒ€ (N=âˆ): 7.69Ã—
# ë‹¬ì„±ë¥ : 5.41 / 7.69 = 70.4%
```

---

## ğŸ’¡ 7. ì‹¤ë¬´ ì ìš© ê°€ì´ë“œ

### ìƒí™©ë³„ êµ¬ì„± ì„ íƒ

#### ì‹œë‚˜ë¦¬ì˜¤ 1: ë¦¬ì†ŒìŠ¤ ì ˆì•½ ìš°ì„ 
```python
ëª©í‘œ: Efficiency â‰¥ 80%
ê¶Œì¥: 2rÃ—1e
ê·¼ê±°:
  - Speedup = 1.64Ã— (64% ì†ë„ í–¥ìƒ)
  - Efficiency = 82.1% (18% ì˜¤ë²„í—¤ë“œ)
  - 2ê°œ CPU ì½”ì–´ë§Œ ì‚¬ìš© (ë¹„ìš© íš¨ìœ¨ì )
```

#### ì‹œë‚˜ë¦¬ì˜¤ 2: ê· í˜•ì¡íŒ ì„±ëŠ¥
```python
ëª©í‘œ: Efficiency â‰¥ 60%, Speedup â‰¥ 2.5Ã—
ê¶Œì¥: 4rÃ—1e
ê·¼ê±°:
  - Speedup = 2.71Ã— (171% ì†ë„ í–¥ìƒ)
  - Efficiency = 67.7% (ì‹¤ìš©ì )
  - 4ê°œ CPU ì½”ì–´ ì‚¬ìš© (ì¼ë°˜ì  ì„¤ì •)
```

#### ì‹œë‚˜ë¦¬ì˜¤ 3: ìµœëŒ€ ì†ë„ ìš°ì„ 
```python
ëª©í‘œ: Speedup ìµœëŒ€í™”
ê¶Œì¥: 8rÃ—2e
ê·¼ê±°:
  - Speedup = 5.41Ã— (ìµœëŒ€ ì„±ëŠ¥)
  - Efficiency = 33.8% (ë‚®ì§€ë§Œ ì†ë„ ìš°ì„ )
  - 16ê°œ í™˜ê²½ ë™ì‹œ ì‹¤í–‰
  - ë¦¬ì†ŒìŠ¤ ì—¬ìœ  ìˆì„ ë•Œë§Œ ì‚¬ìš©
```

### ì˜ì‚¬ê²°ì • í”Œë¡œìš°ì°¨íŠ¸

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ë¦¬ì†ŒìŠ¤ ì ˆì•½ì´ ìµœìš°ì„ ì¸ê°€?            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         Yes              No
         â”‚                 â”‚
    [2rÃ—1e]          â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
   82% íš¨ìœ¨          â”‚ ë¹ ë¥¸ í•™ìŠµ   â”‚
                     â”‚ í•„ìš”í•œê°€?   â”‚
                     â””â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”˜
                      Yes      No
                       â”‚        â”‚
                   [8rÃ—2e]  [4rÃ—1e]
                  5.41Ã— ì†ë„  2.71Ã— ì†ë„
                  34% íš¨ìœ¨   68% íš¨ìœ¨
```

### ìµœì í™” ì²´í¬ë¦¬ìŠ¤íŠ¸

```python
âœ“ ë³‘ë ¬í™” ì „ í™•ì¸ì‚¬í•­:
  â–¡ Baseline (1rÃ—1e) SPS ì¸¡ì • ì™„ë£Œ
  â–¡ ì‹œìŠ¤í…œ ì‚¬ì–‘ í™•ì¸ (CPU ì½”ì–´ ìˆ˜, GPU)
  â–¡ ë©”ëª¨ë¦¬ ì—¬ìœ  í™•ì¸ (RAM, VRAM)

âœ“ êµ¬ì„± ì„ íƒ ê¸°ì¤€:
  â–¡ Efficiency > 60% ìœ ì§€
  â–¡ CPU ì‚¬ìš©ë¥  < 80% (headroom í™•ë³´)
  â–¡ RAM ì‚¬ìš©ë¥  < 80%

âœ“ ì„±ëŠ¥ ê²€ì¦:
  â–¡ SPS í–¥ìƒ í™•ì¸
  â–¡ Speedupì´ ì˜ˆìƒ ë²”ìœ„ ë‚´
  â–¡ Efficiencyê°€ ì„ê³„ê°’ ì´ìƒ
  â–¡ í•™ìŠµ ì•ˆì •ì„± ìœ ì§€ (reward ê·¸ë˜í”„)
```

---

## ğŸ“š 8. ì°¸ê³  ê³µì‹ ìš”ì•½

### í•µì‹¬ ê³µì‹

```python
# 1. SPS (ì²˜ë¦¬ëŸ‰)
SPS = num_env_steps_sampled / time_this_iter_s

# 2. Speedup (ê°€ì†ë¹„)
Speedup = T_baseline / T_parallel
        = SPS_parallel / SPS_baseline

# 3. Efficiency (íš¨ìœ¨ì„±)
Efficiency = (Speedup / Parallelism) Ã— 100%
           = (T_baseline / T_parallel / N) Ã— 100%

# 4. Parallelism (ë³‘ë ¬í™” ìˆ˜ì¤€)
N = num_env_runners Ã— num_envs_per_env_runner

# 5. Amdahl's Law (ì´ë¡ ì  í•œê³„)
Speedup_max = 1 / (s + (1-s)/N)
```

### ê´€ê³„ì‹

```python
# SPSì™€ Speedupì˜ ê´€ê³„
Speedup = SPS_parallel / SPS_baseline
        = (steps / T_parallel) / (steps / T_baseline)
        = T_baseline / T_parallel

# Efficiencyì™€ ì†ì‹¤ì˜ ê´€ê³„
Loss = 100% - Efficiency
     = 100% - (Speedup / N) Ã— 100%
     = (N - Speedup) / N Ã— 100%

# ì´ìƒì  Speedupê³¼ ì‹¤ì œì˜ ì°¨ì´
Gap = Ideal_Speedup - Actual_Speedup
    = N - Speedup
    
Efficiency = (1 - Gap/N) Ã— 100%
```

### ë‹¨ìœ„ ì²´í¬

```python
SPS: steps/second [stepsÂ·sâ»Â¹]
Time: seconds [s]
Speedup: ë°°ìˆ˜ [dimensionless]
Efficiency: í¼ì„¼íŠ¸ [%]
Parallelism: ê°œìˆ˜ [dimensionless]
```

---

## ğŸ§® 9. ì‹¤ìŠµ ì˜ˆì œ

### ì—°ìŠµ ë¬¸ì œ

**ì£¼ì–´ì§„ ê°’:**
```python
êµ¬ì„±: 6rÃ—2e (6 runners, 2 envs per runner)
T_baseline = 11.89s (1rÃ—1e)
T_parallel = 3.45s
num_env_steps = 16,384
```

**ê³„ì‚°:**

```python
# 1. Parallelism
N = 6 Ã— 2 = 12

# 2. Speedup
Speedup = 11.89 / 3.45 = 3.45Ã—

# 3. Efficiency
Efficiency = (3.45 / 12) Ã— 100% = 28.7%

# 4. SPS
SPS_baseline = 16,384 / 11.89 = 1,378 steps/s
SPS_parallel = 16,384 / 3.45 = 4,749 steps/s

# 5. Speedup ê²€ì¦ (SPS ê¸°ë°˜)
Speedup = 4,749 / 1,378 = 3.45Ã— âœ“

# 6. í‰ê°€
Efficiency = 28.7% < 40% â†’ ë¹„íš¨ìœ¨ì 
ê¶Œì¥: ë” ì ì€ ë³‘ë ¬í™” ìˆ˜ì¤€ ê³ ë ¤
```

---

## âœ… ìš”ì•½ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ì¸¡ì • ì‹œ ë°˜ë“œì‹œ í™•ì¸

- [ ] **SPS ì¸¡ì •**: `num_env_steps / time_this_iter_s`
- [ ] **Baseline í™•ë¦½**: 1rÃ—1e êµ¬ì„±ìœ¼ë¡œ ê¸°ì¤€ ì„¤ì •
- [ ] **Speedup ê³„ì‚°**: `T_baseline / T_parallel`
- [ ] **Efficiency ê³„ì‚°**: `(Speedup / N) Ã— 100%`
- [ ] **ëª©í‘œ ë‹¬ì„± ì—¬ë¶€**: Efficiency â‰¥ 60% ê¶Œì¥

### í•´ì„ ì‹œ ê³ ë ¤ì‚¬í•­

- [ ] SPSê°€ ë†’ë‹¤ = ë¹ ë¥¸ í•™ìŠµ
- [ ] Speedupì´ í¬ë‹¤ = í° ì„±ëŠ¥ í–¥ìƒ
- [ ] Efficiencyê°€ ë†’ë‹¤ = íš¨ìœ¨ì  ìì› í™œìš©
- [ ] Efficiency < 40% = ê³¼ë„í•œ ë³‘ë ¬í™”, ì¬ê²€í†  í•„ìš”
- [ ] Amdahl's Lawë¡œ ì´ë¡ ì  í•œê³„ ì˜ˆì¸¡ ê°€ëŠ¥

---

**ì‘ì„±ì¼**: 2025-11-11  
**ì‹¤í—˜ í™˜ê²½**: HalfCheetah-v5 (MuJoCo) + PPO  
**ì‹œìŠ¤í…œ**: Intel i7-12700, NVIDIA RTX 3070  
